<!DOCTYPE html>
<html lang="no">

<head>
  <meta charset="UTF-8">
  <title>Bestill Bord — Tangen Torv</title>
  <link rel="stylesheet" href="bestill.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>

  <nav class="nav">
    <div class="nav-left">
      <a href="index.html">Hjem</a>
      <a href="meny.html">Meny</a>
      <a href="bestill.html">Bestill</a>
      <a href="ansatte.html">Ansatte</a>
      <a href="kontakt.html">Kontakt</a>
    </div>

    <div class="logo">TANGEN TORV</div>

    <div class="nav-right">
      <button class="login-btn" onclick="openLogin()">Logg inn</button>
    </div>
  </nav>

  <header class="hero">
    <div class="hero-content">
      <h1>Bestill Bord</h1>
      <p>Reserver bord hos oss – fyll inn skjemaet under</p>
    </div>
  </header>

  <section class="form-section">
    <form id="bookingForm">
      <label for="first_name">Fornavn:</label>
      <input type="text" id="first_name" name="first_name" required>

      <label for="last_name">Etternavn:</label>
      <input type="text" id="last_name" name="last_name" required>

      <label for="email">E-post:</label>
      <input type="email" id="email" name="email" required>

      <label for="phone">Telefon:</label>
      <input type="text" id="phone" name="phone" required>

      <label for="table_id">Velg bord:</label>
      <select id="table_id" name="table_id" required>
        <option value="1">Bord 1 - Vindusutsikt</option>
        <option value="2">Bord 2 - Bar</option>
        <option value="3">Bord 3 - Midt i rommet</option>
        <option value="4">Bord 4 - Uteplass</option>
      </select>

      <label for="guests">Antall personer:</label>
      <input type="number" id="guests" name="guests" min="1" required>

      <label for="date">Dato:</label>
      <input type="date" id="date" name="date" required>

      <label for="time">Tidspunkt:</label>
      <input type="time" id="time" name="time" required>

      <label for="note">Notat (valgfritt):</label>
      <input type="text" id="note" name="note">

      <button type="submit">Send inn</button>
      <p id="feedback"></p>
    </form>
  </section>

  <script>
    document.getElementById('bookingForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const feedback = document.getElementById('feedback');

      const data = {
        first_name: document.getElementById('first_name').value,
        last_name: document.getElementById('last_name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        table_id: document.getElementById('table_id').value,
        booking_time: document.getElementById('date').value + 'T' + document.getElementById('time').value,
        guests: parseInt(document.getElementById('guests').value),
        note: document.getElementById('note').value
      };

      try {
        const response = await fetch('http://localhost:4000/bookings', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        if (response.ok) {
          feedback.textContent = "Takk! Reservasjonen er registrert.";
          feedback.style.color = "#d8b06a";
          this.reset();
        } else {
          const resData = await response.json();
          feedback.textContent = "Feil: " + (resData.error || "Noe gikk galt.");
          feedback.style.color = "red";
          console.log(resData); // Se feilmelding i konsollen
        }
      } catch (err) {
        feedback.textContent = "Kunne ikke kontakte serveren.";
        feedback.style.color = "red";
        console.error(err);
      }
    });
  </script>

</body>

</html>